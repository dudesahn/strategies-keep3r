import { run, ethers, network } from 'hardhat';
import * as etherscan from '../../utils/etherscan';
import { promises as fs } from 'fs';

const strategies = [
  '0x0A5157244e4F82F100A461CA65C7b05C8dACf835',
  '0xbC27C4873D0ddE214387cE5a838DC78857633Ea2',
  '0x66252E6ff02c45f00fBc071c2F3Cf0eb13B2dE19',
  '0x4050eB90c15F27aa75b5CFcb934a26fDE60Cf9Cb',
  '0x979843B8eEa56E0bEA971445200e0eC3398cdB87',
  '0x6C0496fC55Eb4089f1Cf91A4344a2D56fAcE51e3',
  '0xfE17a13958Fe2f7a0b9A0759de0E9747f5658D61',
  '0x22D07F42Cf4D077E765560ff6A741eF8E851091c',
  '0x3E14d864E4e82eD98849Bf666971f39Cf49Ca986',
  '0x619Dde92f9fD8Af679025A2fD7e9ED2269e4c0c8',
  '0x036099f243E135cf2ADF449C2dD5497Da20FB82D',
  '0x4155f2aDc918EEba038C31772027A2eF15DbD73c',
  '0xb85413f6d07454828eAc7E62df7d847316475178',
  '0x4b254EbBbb8FDb9D3E848501784692b2726b310c',
  '0x29367915508e47c631d220caEbA855901c13a3dE',
  '0x64B2a32f030D9210E51ed8884C0D58b89137Ca81',
  '0x7c1612476D235c8054253c83B98f7Ca6f7F2E9D0',
  '0x8C818613A97900CC1EDA5893F04701b62e7c1138',
  '0x1A5890d45090701A35D995Be3b63948A67460341',
  '0xbC0F2FF495eE2eb74A145EDAA457FA4Fa310DAC5',
  '0x9F7982a604add48BBBbe1644A9a6C4Db5E759Ad7',
  '0x7FF6D8EC53Cb4f6d44e9471391339f5b772EaEF4',
  '0xE5f7f2E59B259E11EcF2Ff76fDf5dC7438363A3f',
  '0xec2DB4A1Ad431CC3b102059FA91Ba643620F0826',
  '0x83B6211379c26E0bA8d01b9EcD4eE1aE915630aa',
  '0xd28b508EA08f14A473a5F332631eA1972cFd7cC0',
  '0xF9fDc2B5F60355A237deb8BD62CC117b1C907f7b',
  '0xc57A4D3FBEF85e675f6C3656498beEfe6F9DcB55',
  '0x0967aFe627C732d152e3dFCAdd6f9DBfecDE18c3',
  '0xb698f815918e0A11cf802184f36f02cD4602EBD4',
  '0x580Ae3AeD3E8e8d83c970FA6D2766C0Fb8AF759F',
  '0xc31763c0c3025b9DF3Fb7Cb7f4AC041866F64F2E',
  '0x86eD4F77d40182b8686a25e125FB3f5a04203CaA',
  '0xB12F6A5776EDd2e923fD1Ce93041B2000A22dDc7',
  '0x3D6532c589A11117a4494d9725bb8518C731f1Be',
  '0x3280499298ACe3FD3cd9C2558e9e8746ACE3E52d',
  '0xC8f17f8E15900b6D6079680b15Da3cE5263f62AA',
  '0x1676055fE954EE6fc388F9096210E5EbE0A9070c',
  '0x1D371Ae86c8316917373Ec572B18776655Fd11b7',
  '0xa6D1C610B3000F143c18c75D84BaA0eC22681185',
  '0x9cfF0533972da48Ac05a00a375CC1a65e87Da7eC',
  '0xC9db3AF6603329dF6C85E168D41B74832452ef08',
  '0x0cF55d57d241161E0ec68E72cBB175dbFe84173a',
  '0x41d638024C525C70A53b883608048e705e061F2c',
  '0x0Ce77bc655aFaAc83947c2e859819185966Ca825',
  '0x86Aa49bf28d03B1A4aBEb83872cFC13c89eB4beD',
  '0x7900c70a377f89DF29D1D1939469ae3B74c5B740',
  '0xC0176FAa0e20dFf3CB6B810aEaE64ef271B1b64b',
  '0x387fCa8d7e2e09655b4F49548607B55C0580fC63',
  '0x2B1a6CB0168aA540ee8D853aB1d10d7A89d6351b',
  '0x80af28cb1e44C44662F144475d7667C9C0aaB3C3',
  '0x520BF095FA58cB3f68C18D01746041733A1f7b85',
  '0x6D892A5585F45f3C45A238C717AA0a228aE69e2C',
  '0xf0aAba6bb8E6bAE83Ea984BC4b7dcf0fF54a8FEF',
  '0xEeabc022EA72AFC585809214a43e1dDF3b34FBB6',
  '0x7Ed0d52C5944C7BF92feDC87FEC49D474ee133ce',
  '0x2923a58c1831205C854DBEa001809B194FDb3Fa5',
  '0x24345144c80BC994C12d85fb276bB4c5520579Ea',
  '0x7aB4DB515bf258A88Bb14f3685769a0f70B8778f',
  '0x9eCC1abbA680C5cAACA37AD56E446ED741d86731',
  '0x7799F476522Ebe259fc525C1A21E84f7Dd551955',
  '0x106838c85Ab33F41567F7AbCfF787d7269E824AF',
  '0xF5636591256195414f25d19034B70A4742Fc2A2e',
  '0x126e4fDfa9DCEA94F8f4157EF8ad533140C60fC7',
  '0xDb2D3F149270630382D4E6B4dbCd47e665D78D76',
  '0xf726472B7BE7461001df396C55CAdB1870c78dAE',
  '0x7b5cb4694b0A299ED2F65db7d87B286461549e84',
  '0xE13C452b5F10686366C2183964341A01A24d9984',
  '0x789685963DF287337759A9FaB65d8c645a3B4cba',
  '0xe9Fd1BEfdd412C8966689A64dE74a783AfA6AD57',
  '0xE9ac8D34C546CBfdAD98F9a4546Db5fE08D01bF2',
  '0x060E04305C07DdE40A9f57bB4fFAcd662D51Ab96',
  '0x07fb6A53185E2F095253099A47F34CD410eB2A89',
  '0x2f87c5e8396F0C41b86aad4F3C8358aB21681952',
  '0x82292B8035873d7DD8a96767F6b3F885564aa919',
  '0x01b54c320d6B3057377cbc71d953d1BBa84df44e',
  '0xf840d061E83025F4cD6610AE5DDebCcA43327f9f',
  '0x3ef6Ec70D4D8fE69365C92086d470bb7D5fC92Eb',
  '0x8423590CD0343c4E18d35aA780DF50a5751bebae',
  '0x8c312B63Bc4000f61E1C4df4868A3A1f09b31A73',
  '0x5e882c9f00209315e049B885B9b3dfbEe60D80A4',
  '0x6EB00860260CF51623737e17579Db797d71cd337',
  '0x9Ae0B9a67cF5D603847980D95Ad4D45b57Ff7783',
  '0x60A3D5bEeEED797ccFf709ee78A42E2cF67235B7',
  '0xB3E1a513a2fE74EcF397dF9C0E6BCe5B57A961C8',
  '0x3cA0B4d7eedE71061B0bAdb4F0E86E99b0FEa613',
  '0xdDAAc8B5Dd65d079b6572e43890BDD8d95bD5cc3',
  '0x9C1117cf2ED3A0F4A9F069001F517c1D511c8B53',
  '0x2D42CFdC6a1B03490892AdF7DC6c62AA7228E5D6',
  '0x6d45c5a8C1cF1f77Ab89cAF8D44917730298bab7',
  '0x9d7c11D1268C8FD831f1b92A304aCcb2aBEbfDe1',
  '0xeC088B98e71Ba5FFAf520c2f6A6F0153f1bf494B',
  '0xF088aC5ebf8423b894903312AaC8Ac42c3Ab3A02',
  '0x270101459e9A38Db38Ba4Cb8718FfA31953A9Af3',
  '0xD670439D889f9Eb16497d8D6EA9a5E549ae5bFF5',
  '0xA44F947e51Ec6456A1d786F82ea5865F87Da9C30',
  '0x4C547b6202247E7B7c45A95d7747A85704530ab3',
  '0x33d7E0Fa2c7Db85Ef3AbC1C44e07E0b5cB2E4C14',
  '0xbf811462955DEeD9aaD62EFE771E34e8B5811857',
  '0x0921E388e86bbE0356e37413F946ccE47EDd294D',
  '0xf9fF7f463A7e6f43d4E65c230D3743355fC954e4',
  '0x75be6ABC02a010559Ed5c7b0Eab94abD2B783b65',
  '0x215DeE632335829155Dcb62452c4878C48c1C884',
  '0x74b3E5408B1c29E571BbFCd94B09D516A4d81f36',
  '0x95eA1643699F8DE347975F31CA8d03eCC507616c',
  '0x29d23b73Dd0ed729F516bb55622765AF102f0e33',
  '0xc9a62e09834cEdCFF8c136f33d0Ae3406aea66bD',
  '0xFB5F4E0656ebfF31743e674d324554fd185e1c4b',
  '0x9730F52AB5BcEc960bE41b0fE4913a09c0B57066',
  '0xFA773b91b59B0895877c769000b9824b46b13a20',
  '0x0E94D346D8A53FEF83484b178a581695E0001E55',
  '0xb7f013426d33fe27e4E8ABEE58500268554736bD',
  '0x23a09D84e50fF3fDFa270308851443734b0a4b6D',
  '0x8e87e65Cb28c069550012f92d5470dB6EB6897c0',
  '0x94fA3A90E680f6b866545C904D1dc9DEe6416de9',
  '0xfb0702469A1a0440E87C06605461E8660FD0F43d',
  '0x31CD90D60516ED18750bA49b2C9d1053190F40d9',
  '0xf8Fb278DeeaF30Ff3F6326d928A61eA8b9397d16',
  '0x16468a3999d931Dd6b6ffA0086Cf195D6C5BDAFA',
  '0x8E4AA2E00694Adaf37f0311651262671f4d7Ac16',
  '0x32EF165F2ABbdbE7dcC25B86EdB14a2C0dc52571',
  '0xB194dCFF4E11d26919Ce3B3255F69aEca5951e88',
  '0xB11FC91DF59ADc604485f1B25ABa1F96A685473f',
  '0xAC4AE0B06C913dF4608dB60E2571a8e91b74C619',
  '0x5ED527A2cfC5411EB63b12E46e270b07b6813824',
  '0xdC929e76081a78e5c32552C2e79D29ECab3F6755',
  '0xd61216954cC49d164Fa3d3cE27823310A61FF46F',
  '0xC45b3312c0DE684301a58A1eee558151BBE8f45c',
  '0xa2a182C5B5Ea1A3c90Cb5Bb718F9e62DBE052927',
  '0x8198815871a45A5a883d083B7B105927eb9919D8',
  '0x136fe75bfDf142a917C954F58577DB04ef6F294B',
  '0x906f0a6f23e7160eB0927B0903ab80b5E3f3950D',
  '0x5D411D2cde10e138d68517c42bE2808C90c22026',
  '0x4ce03bCFC3122eB0F724b94913629c6062949947',
  '0xCc39eC658Eedb7e44f5aeD9B5192219982D2c9e5',
  '0x60A335509E75175E0fF785091f1Baf979148A290',
  '0xe995E461f88358bF3a1F253AA01AAdCd3b7FAd3a',
  '0x5Fa22A8527Ae20f4ed8Ed3E0a6A5359Ad5EA3A4e',
  '0x13BC3530829528aEE7261Fe3C4936aBA289BbA54',
  '0x096E2F730c6AB7a048de7d27507E5E4e864c6824',
  '0xb5921C281503Bb58fD707cE21dA531736434b0f5',
  '0x57D2E2eD281650A5d987E6ef87BC1BeD4fD0E959',
  '0xA7A5BFf106d5E7aA601F6D540c5034Ca2a13787B',
  '0xbA9052141cEf06FD55733D23231c37Fc856CE6F4',
  '0x2055CFD5CDbc90c60A202A1AC3DDfB71AeC1cE98',
  '0x9a5AfC29186b5d27F12F8CE6fe9E6Bd2cbb2BCDC',
  '0x95730d3E374b5E1F5b550Af059Af86D23feA79e3',
  '0x79Be3edA1d7FE92c18B9539bce2611bf8dc9BFc5',
  '0xB71252D990483079ccf76a85b623059b5e33D3db',
  '0x564bf2844654f149821697cC56572eE4384c05f7',
  '0x26AB2029083909FeEFF8Cb0fA04c1CfF52499DE7',
  '0x5E10E27DEae12877e23A68cC0d6F1b134b4d517A',
  '0x9E1FF8638a2F1aD4B924A4B9677aD9d9b74361Cf',
  '0x6570B0a1593a59CcB378fb0b01A753875FCa99c4',
  '0xDCecD8DC5F3dDD480d2A06C56063DBf9c2a07E09',
  '0xAF6F42bfB29e90dFe51f2341fF1B1f99Fd776A70',
  '0x33631575B027Ad75aEBbc9c829FbD0e18Fec91D2',
  '0x214D14f94a63B1714CCc39d12b4942e8Fdd56bA7',
  '0xf35b8ee147a5Fb4c88C39419c843343814fEC64a',
  '0x73c3533c159F93C924f072B065F9DAA6C0445Be2',
  '0x1033927C70E278dd9A985B10F3B7502fb390108C',
  '0x6CfAcEf79cA2AaE173Dc5089b9179a4193dC5784',
  '0xCfB83Ead756d83a04F5AC68e2A7Ea46e62fE61BD',
  '0x68d8dAd442102d1aECCa4f71246E20eBA9ab7216',
  '0x99636ECcC231945FBB33AbDdE14F174D9C6bCa4D',
  '0xEe350e2B29AdD6504dDd81D3b6e3Dc4bA06A57B4',
  '0xC7861a5438E99C3d7C5bBcabfc3FB5516ec70019',
  '0xf432da3d838111Bbc9F4B4D441Aaac8871597634',
  '0x81329ecb1AB448DacF6b9ae696A097f790898899',
  '0x240f5167A98Bc2198110BcdD4CB04D06Dd52d55d',
  '0x3f4a63F3Ee9bA49004953f6879c7516D85969F5F',
  '0x4ec142d094BecA5f7789CCd9341D0215c8B1e43f',
  '0x7847b7027cab6Fc4ea08cA0fF3b7464727712f91',
  '0x3199437193625DCcD6F9C9e98BDf93582200Eb1f',
  '0xbb241fD9A2A3742ef9E10ccfd8a6C4E0EbEb03f2',
  '0x5796698A29F3626c9FE13C4d3d3dEE987c84EBB3',
];

async function main() {
  await run('compile');
  await promptAndSubmit();
}

function promptAndSubmit(): Promise<void | Error> {
  return new Promise(async (resolve, reject) => {
    const [owner] = await ethers.getSigners();
    console.log('using address:', owner.address);
    let index = 0;
    try {
      for (const strategy of strategies) {
        try {
          const strategyContract = await ethers.getContractAt('IBaseStrategy', strategy);
          const name = await strategyContract.callStatic.name();
          console.log(strategy, 'name:', name);
          const data = await etherscan.getContractCode(strategy);
          console.log(data.ContractName);
          await fs.writeFile(`./contracts-no-compile/strategies/${name}-${data.ContractName}-${strategy}.sol`, data.SourceCode);
          index++;
          console.log(index);
        } catch (error) {
          console.log(strategy, 'error:');
          console.log(error);
        }
      }

      resolve();
    } catch (err) {
      reject(`Error on get strategy code: ${(err as any).message}`);
    }
  });
}

main()
  .then(() => process.exit(0))
  .catch((error) => {
    console.error(error);
    process.exit(1);
  });
